library(UCSCXenaTools)
library(IOBR)
setwd("~/Documents/onedrive/Documentos/GitHub/repertorio-TCR-BCR-tcga-ACC/04_anlytics/02_lymphocyte_fraction")
## -- download da matriz de expressao genica atraves do xenabrowser
eset_acc<-XenaGenerate(subset = XenaCohorts =="GDC TCGA Adrenocortical Cancer (ACC)") %>%
XenaFilter(filterDatasets    = "TCGA-ACC.htseq_counts.tsv") %>%
XenaQuery() %>%
XenaDownload() %>%
XenaPrepare()
## -- anotacao e normalizacao em TPM
eset_acc$Ensembl_ID <- gsub("\\..*","",eset_acc$Ensembl_ID) # remocao da versao
eset_acc <- column_to_rownames(eset_acc, var = "Ensembl_ID")
eset_acc <- (2^eset_acc)+1 # revertendo para a contagem original (pois estao em log2)
eset_acc <- count2tpm(countMat = eset_acc, idType = "Ensembl") # normalizacao em TPM
epic <- deconvo_tme(eset = log2(eset_acc+1), method = "epic", arrays = FALSE)
head(epic)
save(epic, "epic.RData")
save(epic, file = "epic.RData")
save(eset_acc, file = "eset_acc_xenabrowser.RData")
xcell <- deconvo_tme(eset = log2(eset_acc+1), method = "xcell", arrays = FALSE)
head(xcell)
mcp <- deconvo_tme(eset = log2(eset_acc+1), method = "mcpcounter", arrays = FALSE)
head(mcp)
estimate <- deconvo_tme(eset = log2(eset_acc+1), method = "estimate", arrays = FALSE)
head(estimate)
timer <- deconvo_tme(eset = log2(eset_acc+1),
method = "timer",
group_list = rep("acc",ncol(eset_acc)),
arrays = FALSE)
head(timer)
