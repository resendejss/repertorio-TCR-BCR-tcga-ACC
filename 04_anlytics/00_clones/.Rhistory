setwd("/media/jean/RODRIGO DISNER_II/RNASeq_IPPPP/main/PreProcSEQ-main/")
getwd()
dir.principal <- getwd()
dir.amostras_69 <- "/media/jean/RODRIGO DISNER_II/RNASeq_IPPPP/ftp.ipec.org.br/Seq_69/FastQ/Untitled_from_240112_A01161_0069_AHLTMGDRX3-407367966/FASTQ_Generation_2024-01-13_15_48_42Z-714099388/"
dir.amostras_70 <- "/media/jean/RODRIGO DISNER_II/RNASeq_IPPPP/ftp.ipec.org.br/Seq_70/FastQ/Untitled_from_240116_A01161_0070_AHMLK5DRX3-407630226/FASTQ_Generation_2024-01-17_09_03_53Z-714533830/"
list.files(dir.amostras_69)
list.files(dir.amostras_70)
length(list.files(dir.amostras_69)) + length(list.files(dir.amostras_70)) # 90
samplesNames.seq_69 <- NULL
for (i in 1:length(list.files(dir.amostras_69))) {
samplesNames.seq_69 <- c(samplesNames.seq_69,
list.files(paste(dir.amostras_69,
list.files(dir.amostras_69)[i],
sep = "/")))
}
samplesNames.seq_70 <- NULL
for (i in 1:length(list.files(dir.amostras_70))) {
samplesNames.seq_70 <- c(samplesNames.seq_70,
list.files(paste(dir.amostras_70,
list.files(dir.amostras_70)[i],
sep = "/")))
}
samplesNames.seq_69.unique <- unique(gsub("_R._001.fastq.gz", "",
samplesNames.seq_69))
samplesNames.seq_70.unique <- unique(gsub("_R._001.fastq.gz", "",
samplesNames.seq_70))
getwd()
samplesNames.seq_70.unique
samplesPath.seq_69 <- NULL
for (i in 1:length(samplesNames.seq_69.unique)) {
samplesPath.seq_69 <- c(samplesPath.seq_69, paste(list.files(dir.amostras_69)[i],"/",samplesNames.seq_69.unique[i], sep = ""))
}
samplesPath.seq_69
samplesPath.seq_70 <- NULL
for (i in 1:length(samplesNames.seq_70.unique)) {
samplesPath.seq_70 <- c(samplesPath.seq_70, paste(list.files(dir.amostras_70)[i],"/",samplesNames.seq_70.unique[i], sep = ""))
}
write.table(samplesPath.seq_70, "samplesPath_seq70.txt",
quote = F, row.names = F, col.names = F)
if (!requireNamespace("IOBR", quietly = TRUE))  devtools::install_github("IOBR/IOBR")
install.packages("devtools")
install.packages("systemfonts")
install.packages("systemfonts")
install.packages("textshaping")
install.packages("textshaping")
install.packages("ragg")
install.packages("pkgdown")
install.packages("devtools")
if (!requireNamespace("IOBR", quietly = TRUE))  devtools::install_github("IOBR/IOBR")
BiocManager::install("clusterProfiler")
install.packages("igraph")
install.packages("igraph")
install.packages("igraph")
install.packages("tidygraph")
install.packages("graphlayouts")
install.packages("ggraph")
BiocManager::install("enrichplot")
BiocManager::install("clusterProfiler")
install.packages("nloptr")
install.packages("nloptr")
install.packages("lme4")
install.packages("pbkrtest")
install.packages("car")
install.packages("rstatix")
install.packages("survminer")
install.packages("ggpubr")
devtools::install_github("IOBR/IOBR")
load("7-normalizationCounts/tmm/gse_tmm.RData")
load(("7-normalizationCounts/tpm/gse_tpm.RData"))
library(immunarch)
immdata <- repLoad("../../../../Projetos/Bigdata/BigData/BigData/repertorio_tcrbcr_acc/data/outputTrust4_report/")
library(immunarch)
setwd("Documents/onedrive/Documentos/GitHub/repertorio-TCR-BCR-tcga-ACC/04_anlytics/00_clones")
dir_data <- "../../../../Projetos/Bigdata/BigData/BigData/repertorio_tcrbcr_acc/data/"
immdata <- repLoad(paste(dir_data, "outputTrust4_report", sep = ""))
load(paste(dir_data, "metadata.RData", sep = ""))
immdata$meta <- metadata[metadata$sample_id %in% gsub("_report", "", immdata$meta$Sample),]
# separar os grupos high e low
immdata$meta$steroid
immdata$meta$Sample <- paste(immdata$meta$sample_id,"_report",sep = "")
immdata_bcr <- repFilter(immdata,
.method = "by.clonotype",
.query = list(V.name = include("IG")),
.match = "substring")
immdata_tcr <- repFilter(immdata,
.method = "by.clonotype",
.query = list(V.name = include("TR")),
.match = "substring")
# -- dist: group sequence by V.name, J.name and length CDR3
dist_BCR <- seqDist(immdata_bcr$data,
.group_by = c("V.name", "J.name"),
.group_by_seqLength = TRUE,
.col = "CDR3.nt")
clust_BCR <- seqCluster(immdata_bcr$data, dist_BCR, .perc_similarity = 0.9)
immdata_tcr$data[-12]
immdata_tcr$data$
immdata_tcr$data$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`
dist_TCR <- seqDist(immdata_tcr$data,
.group_by = c("V.name", "J.name"),
.group_by_seqLength = TRUE,
.col = "CDR3.nt")
clust_TCR <- seqCluster(immdata_tcr$data, dist_TCR, .perc_similarity = 0.95)
dist_TCR <- seqDist(immdata_tcr$data[-12],
.group_by = c("V.name", "J.name"),
.group_by_seqLength = TRUE,
.col = "CDR3.nt")
clust_TCR <- seqCluster(immdata_tcr$data[-12], dist_TCR, .perc_similarity = 0.95)
teste <- immdata_tcr$data[12]
teste
clust_TCR$`130723_UNC9-SN296_0386_BC2E4WACXX_ACTTGA_L003_report`$Cluster
teste$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`$V.name
teste$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`$J.name
nchar(teste$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`$CDR3.nt)
teste$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`$Cluster <-
c("TRAV9-2/TRAJ17_length_39","TRAV9-2/TRAJ17_length_39")
temp <- immdata_tcr$data[12]
temp$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`$Cluster <-
c("TRAV9-2/TRAJ17_length_39","TRAV9-2/TRAJ17_length_39")
temp$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`$J.name
nchar(temp$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`$CDR3.nt)
names(temp)
clust_TCR$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report` <-
temp$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`
clust_TCR$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`
clust_TCR$`130723_UNC9-SN296_0386_BC2E4WACXX_ACTTGA_L003_report`
clust_TCR$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report` <-
as.data.frame(temp$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`)
clust_TCR$`130723_UNC9-SN296_0386_BC2E4WACXX_TAGCTT_L006_report`
clust_TCR$`130723_UNC9-SN296_0386_BC2E4WACXX_ACTTGA_L003_report`
